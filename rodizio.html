<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rodízio de Cultos</title>

<style>
body{
 font-family:Arial,Helvetica,sans-serif;
 background:#f4f6f8;
 margin:0;padding:0;
}
.container{
 max-width:900px;
 margin:20px auto;
 background:#fff;
 padding:20px;
 border-radius:10px;
 box-shadow:0 4px 10px rgba(0,0,0,.08)
}
h1{text-align:center;margin:0}
.sub{text-align:center;color:#555;margin-bottom:20px}

select,button,textarea{
 width:100%;
 padding:10px;
 margin-top:8px;
 font-size:15px;
 border-radius:6px;
 border:1px solid #ccc
}
button{
 cursor:pointer;
 font-weight:bold;
 border:none
}
.btn-gerar{background:#1976d2;color:#fff}
.btn-pdf{background:#c62828;color:#fff}
.btn-batismo{background:#455a64;color:#fff}

.section{
 margin-top:25px;
 background:#eee;
 padding:10px;
 font-weight:bold;
 border-radius:6px
}

table{
 width:100%;
 border-collapse:collapse;
 margin-top:10px
}
th,td{
 border:1px solid #ccc;
 padding:8px;
 text-align:center
}
th{background:#f0f0f0}

.batismo{
 background:#e3f2fd;
 font-weight:bold
}
.badge{
 background:#1976d2;
 color:#fff;
 padding:3px 8px;
 border-radius:12px;
 font-size:12px
}

textarea{resize:vertical}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>
<div class="container" id="areaPDF">

<h1>RODÍZIO DE CULTOS</h1>
<div class="sub">Congregação Cristã no Brasil</div>

<select id="mes"></select>

<button class="btn-gerar" onclick="gerar()">Gerar Rodízio</button>
<button class="btn-pdf" onclick="gerarPDF()">Exportar PDF</button>
<button class="btn-batismo" onclick="modoBatismo()">Marcar Batismo</button>

<hr>

<label>Culto (Dom / Ter / Qui)</label>
<textarea id="culto">ABIMAEL
DANIEL
FABIO
JONATAS</textarea>

<label>Reunião de Jovens (Sábado)</label>
<textarea id="reuniao">ABIMAEL
DANIEL FEIRA NOVA</textarea>

<label>Ensaio (Sábado)</label>
<textarea id="ensaio">JONATAS</textarea>

<label>Culto de Jovens (Sábado)</label>
<textarea id="cultoJovem">FABIO</textarea>

<div id="resultado"></div>

</div>

<script>
const diasSemana=["domingo","segunda","terça","quarta","quinta","sexta","sábado"]
let marcar=false

function lista(id){
 return document.getElementById(id).value.split("\n").map(x=>x.trim()).filter(Boolean)
}

function gerarSecao(titulo,ano,mes,dias,lista){
 let html=`<div class="section">${titulo}</div>
 <table><tr><th>Dia</th><th>Data</th><th>Irmão</th><th></th></tr>`
 let i=0
 let total=new Date(ano,mes,0).getDate()
 for(let d=1;d<=total;d++){
  let dt=new Date(ano,mes-1,d)
  if(dias.includes(dt.getDay())){
   html+=`<tr onclick="toggleBatismo(this)">
   <td>${diasSemana[dt.getDay()]}</td>
   <td>${d}/${mes}</td>
   <td>${lista[i++%lista.length]}</td>
   <td></td>
   </tr>`
  }
 }
 return html+"</table>"
}

function gerar(){
 const [ano,mes]=document.getElementById("mes").value.split("-").map(Number)
 let html=""

 html+=gerarSecao("CULTOS",ano,mes,[0,2,4],lista("culto"))
 html+=gerarSecao("REUNIÃO DE JOVENS",ano,mes,[6],lista("reuniao"))
 html+=gerarSecao("ENSAIO",ano,mes,[6],lista("ensaio"))
 html+=gerarSecao("CULTO DE JOVENS",ano,mes,[6],lista("cultoJovem"))

 document.getElementById("resultado").innerHTML=html
}

function modoBatismo(){
 marcar=!marcar
 alert(marcar?"Modo batismo ativado":"Modo batismo desativado")
}

function toggleBatismo(linha){
 if(!marcar) return
 linha.classList.toggle("batismo")
 linha.lastElementChild.innerHTML =
 linha.classList.contains("batismo") ? "<span class='badge'>BATISMO</span>" : ""
}

function gerarPDF(){
 html2pdf().from(document.getElementById("areaPDF")).save("Rodizio.pdf")
}

(function init(){
 const sel=document.getElementById("mes")
 let hoje=new Date()
 for(let i=0;i<24;i++){
  let d=new Date(hoje.getFullYear(),hoje.getMonth()+i,1)
  let opt=document.createElement("option")
  opt.value=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`
  opt.textContent=d.toLocaleString("pt-BR",{month:"long",year:"numeric"})
  sel.appendChild(opt)
 }
 gerar()
})();
</script>
</body>
</html>
