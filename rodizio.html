<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gerador de Rodízio – Portal CCB</title>

<style>
:root{
  --border:#bdbdbd;
  --blue:#1976d2;
  --red:#c62828;
  --bg:#f5f7fb;
}
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:var(--bg);
}
.wrap{
  max-width:1100px;
  margin:20px auto;
  background:#fff;
  padding:16px;
  border-radius:10px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}
h1{
  text-align:center;
  margin:0;
}
.sub{
  text-align:center;
  margin-bottom:16px;
  color:#444;
}
.controls{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
  margin-bottom:16px;
}
input, button{
  padding:10px;
  font-size:14px;
}
button{
  border:none;
  cursor:pointer;
  border-radius:6px;
}
.btn-primary{background:var(--blue);color:#fff}
.btn-pdf{background:var(--red);color:#fff}
.btn-batismo{background:#455a64;color:#fff}

.card{
  border:1px solid var(--border);
  border-radius:8px;
  padding:12px;
  margin-bottom:16px;
}
textarea{
  width:100%;
  min-height:80px;
  margin-bottom:10px;
}

.title-bar{
  background:#e0e0e0;
  padding:8px;
  font-weight:bold;
  margin-top:16px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-bottom:20px;
}
th, td{
  border:1px solid var(--border);
  padding:8px;
}
th{background:#eee}

.batismo{
  background:#e3f2fd !important;
  font-weight:bold;
}
.badge{
  background:#1976d2;
  color:#fff;
  padding:3px 8px;
  border-radius:6px;
  font-size:12px;
}

@media(max-width:768px){
  .controls{flex-direction:column}
}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>
<div class="wrap">
  <h1>RODÍZIO DE CULTOS</h1>
  <div class="sub">Congregação Cristã no Brasil</div>

  <div class="controls">
    <input type="month" id="mes">
    <button class="btn-primary" onclick="gerar()">Gerar Rodízio</button>
    <button class="btn-pdf" onclick="exportarPDF()">Exportar PDF</button>
    <button class="btn-batismo" onclick="marcarBatismo()">Marcar Batismo</button>
  </div>

  <div class="card">
    <strong>Culto (Dom / Ter / Qui)</strong>
    <textarea id="culto">ABIMAEL
DANIEL
FABIO
JONATAS</textarea>

    <strong>Reunião de Jovens</strong>
    <textarea id="reuniao">ABIMAEL
DANIEL FEIRA NOVA</textarea>

    <strong>Ensaio</strong>
    <textarea id="ensaio">JONATAS</textarea>

    <strong>Culto de Jovens</strong>
    <textarea id="cultoJovem">FABIO</textarea>
  </div>

  <div id="resultado"></div>
</div>

<script>
const diasBatismo = [];
const diasSemana = ['domingo','segunda','terça','quarta','quinta','sexta','sábado'];

function gerar(){
  const mesVal = document.getElementById('mes').value;
  if(!mesVal) return alert("Selecione o mês");

  const [ano, mes] = mesVal.split('-').map(Number);
  const diasMes = new Date(ano, mes, 0).getDate();

  const culto = lista('culto');
  let idx = 0;

  let html = `<div class="title-bar">CULTOS</div>
  <table><tr><th>Dia</th><th>Data</th><th>Irmão</th><th></th></tr>`;

  for(let d=1; d<=diasMes; d++){
    const dt = new Date(ano, mes-1, d);
    if([0,2,4].includes(dt.getDay())){
      const data = d+"/"+mes;
      html += linha(dt, data, culto[idx++ % culto.length]);
    }
  }

  html += `</table>`;
  document.getElementById('resultado').innerHTML = html;
  aplicarBatismo();
}

function linha(dt, data, irmao){
  return `<tr>
    <td>${diasSemana[dt.getDay()]}</td>
    <td>${data}</td>
    <td>${irmao}</td>
    <td></td>
  </tr>`;
}

function lista(id){
  return document.getElementById(id).value
    .split('\n').map(l=>l.trim()).filter(Boolean);
}

function marcarBatismo(){
  const data = prompt("Digite a data do batismo (ex: 18/1)");
  if(data){
    diasBatismo.push(data);
    aplicarBatismo();
  }
}

function aplicarBatismo(){
  document.querySelectorAll("table tr").forEach(tr=>{
    const td = tr.children[1];
    if(td && diasBatismo.includes(td.innerText)){
      tr.classList.add("batismo");
      tr.children[3].innerHTML = `<span class="badge">BATISMO</span>`;
    }
  });
}

function exportarPDF(){
  html2pdf().from(document.getElementById("resultado")).save("rodizio.pdf");
}
</script>
</body>
</html>
